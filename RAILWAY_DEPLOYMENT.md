# Railway éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•å°† Claude Code SDK Demo é¡¹ç›®éƒ¨ç½²åˆ° Railway å¹³å°ã€‚

## Railway ä¼˜åŠ¿

- âœ… **å…è´¹è®¡åˆ’**ï¼šæ¯æœˆæä¾› $5 å…è´¹é¢åº¦
- âœ… **é•¿æ—¶é—´è¿è¡Œ**ï¼šæ”¯æŒæŒç»­è¿è¡Œçš„ Node.js åº”ç”¨
- âœ… **ä¿ç•™ CLI åŠŸèƒ½**ï¼šå¯ä»¥å®Œæ•´ä½¿ç”¨ Claude CLI åŠŸèƒ½
- âœ… **è‡ªåŠ¨éƒ¨ç½²**ï¼šGit æ¨é€åè‡ªåŠ¨éƒ¨ç½²
- âœ… **ç¯å¢ƒå˜é‡ç®¡ç†**ï¼šæ–¹ä¾¿çš„ç¯å¢ƒå˜é‡é…ç½®

## éƒ¨ç½²æ­¥éª¤

### 1. å‡†å¤‡ Railway è´¦æˆ·

1. è®¿é—® [Railway.app](https://railway.app)
2. ä½¿ç”¨ GitHub è´¦æˆ·ç™»å½•
3. éªŒè¯é‚®ç®±åœ°å€

### 2. åˆ›å»ºæ–°é¡¹ç›®

1. ç‚¹å‡» "New Project"
2. é€‰æ‹© "Deploy from GitHub repo"
3. é€‰æ‹©ä½ çš„ Claude Code SDK ä»“åº“
4. Railway ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° Node.js é¡¹ç›®

### 3. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```
NODE_ENV=production
PORT=$PORT  # Railway è‡ªåŠ¨æä¾›
```

### 4. Railway ç¯å¢ƒä¸­çš„ Claude CLI è®¤è¯

#### ğŸš€ è‡ªåŠ¨åŒ–è®¤è¯ï¼ˆæ¨èï¼‰

æˆ‘ä»¬å·²ç»åˆ›å»ºäº†å®Œæ•´çš„è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–è®¤è¯æµç¨‹ï¼š

##### å¿«é€Ÿå¼€å§‹ï¼ˆä¸€é”®å¼ï¼‰

```bash
# å®Œæ•´çš„è‡ªåŠ¨åŒ–éƒ¨ç½²å’Œè®¤è¯æµç¨‹
npm run deploy:full

# æˆ–è€…åˆ†æ­¥æ‰§è¡Œ
npm run railway:setup    # è®¾ç½® Railway CLI
npm run railway:auth     # æ‰§è¡Œ Claude CLI è®¤è¯
npm run railway:verify   # éªŒè¯è®¤è¯çŠ¶æ€
```

##### è‡ªåŠ¨åŒ–è„šæœ¬è¯´æ˜

| è„šæœ¬å‘½ä»¤ | åŠŸèƒ½æè¿° |
|---------|----------|
| `npm run railway:setup` | è‡ªåŠ¨å®‰è£…å’Œé…ç½® Railway CLI |
| `npm run railway:auth` | åŠè‡ªåŠ¨åŒ– Claude CLI è®¤è¯æµç¨‹ |
| `npm run railway:verify` | éªŒè¯åº”ç”¨å’Œè®¤è¯çŠ¶æ€ |
| `npm run railway:health` | æ‰§è¡Œå¥åº·æ£€æŸ¥ |
| `npm run railway:monitor` | å¯åŠ¨æŒç»­ç›‘æ§æ¨¡å¼ |
| `npm run deploy:setup` | å®Œæ•´çš„è®¾ç½®å’Œè®¤è¯æµç¨‹ |
| `npm run deploy:full` | æ„å»ºéƒ¨ç½² + è®¾ç½®è®¤è¯ + éªŒè¯ |
| `npm run deploy:auto` | å®Œæ•´çš„è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹ |

#### ğŸ”§ æ‰‹åŠ¨è®¤è¯æ­¥éª¤

å¦‚æœè‡ªåŠ¨åŒ–è„šæœ¬æ— æ³•ä½¿ç”¨ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨å®Œæˆè®¤è¯ï¼š

1. **ç­‰å¾…éƒ¨ç½²å®Œæˆ**ï¼šç¡®ä¿åº”ç”¨æˆåŠŸéƒ¨ç½²åˆ° Railway

2. **å¯åŠ¨ Railway ç»ˆç«¯**ï¼š
   - è¿›å…¥ Railway é¡¹ç›®æ§åˆ¶å°
   - ç‚¹å‡» "Terminal" æˆ– "Web Terminal"
   - ç­‰å¾…ç»ˆç«¯å¯åŠ¨å®Œæˆ

3. **éªŒè¯ CLI å®‰è£…**ï¼š
   ```bash
   claude --version
   ```
   åº”è¯¥æ˜¾ç¤º Claude CLI ç‰ˆæœ¬ä¿¡æ¯

4. **è¿è¡Œè®¤è¯å‘½ä»¤**ï¼š
   ```bash
   claude login
   ```

5. **å®Œæˆ OAuth è®¤è¯**ï¼š
   - å‘½ä»¤ä¼šæä¾›ä¸€ä¸ªè®¤è¯ URL
   - å¤åˆ¶ URL åˆ°æµè§ˆå™¨ä¸­æ‰“å¼€
   - ä½¿ç”¨ä½ çš„ Anthropic è´¦æˆ·ç™»å½•
   - æˆæƒå®Œæˆåï¼ŒCLI ä¼šæ˜¾ç¤ºè®¤è¯æˆåŠŸ

6. **éªŒè¯è®¤è¯çŠ¶æ€**ï¼š
   ```bash
   claude auth status
   ```

7. **é‡å¯åº”ç”¨**ï¼ˆå¯é€‰ï¼‰ï¼š
   - åœ¨ Railway æ§åˆ¶å°é‡å¯åº”ç”¨
   - æˆ–ç­‰å¾…åº”ç”¨è‡ªåŠ¨é‡å¯

#### é‡è¦æç¤º

- **æ¯æ¬¡é‡æ–°éƒ¨ç½²**ï¼šRailway é‡æ–°éƒ¨ç½²åå¯èƒ½éœ€è¦é‡æ–°è®¤è¯
- **è®¤è¯æŒä¹…æ€§**ï¼šè®¤è¯ä»¤ç‰Œé€šå¸¸åœ¨ Railway å®¹å™¨é‡å¯åä»ç„¶æœ‰æ•ˆ
- **å¤šç¯å¢ƒé—®é¢˜**ï¼šå¦‚æœä½¿ç”¨å¤šä¸ª Railway ç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒéƒ½éœ€è¦å•ç‹¬è®¤è¯

### 5. éƒ¨ç½²é…ç½®

é¡¹ç›®å·²åŒ…å«ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š

#### `railway.json`
```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "cd demo-real && npm install && npm start",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  },
  "environments": {
    "production": {
      "variables": {
        "NODE_ENV": "production",
        "PORT": "$PORT"
      }
    }
  }
}
```

#### `Procfile`
```
web: cd demo-real && npm install && npm start
```

### 6. è‡ªåŠ¨éƒ¨ç½²

1. æ¨é€ä»£ç åˆ° GitHub ä»“åº“
2. Railway ä¼šè‡ªåŠ¨æ£€æµ‹æ›´æ”¹å¹¶å¼€å§‹éƒ¨ç½²
3. éƒ¨ç½²å®Œæˆåï¼ŒRailway ä¼šæä¾›ä¸€ä¸ªå…¬å…± URL

### 7. è®¿é—®åº”ç”¨

éƒ¨ç½²æˆåŠŸåï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ç«¯ç‚¹è®¿é—®åº”ç”¨ï¼š

- **ä¸»é¡µ**: `https://your-app.railway.app/`
- **å¥åº·æ£€æŸ¥**: `https://your-app.railway.app/api/health`
- **CLI çŠ¶æ€**: `https://your-app.railway.app/api/auth-check`
- **æµå¼æ¼”ç¤º**: `https://your-app.railway.app/simple-real-demo.html`

## 8. æœ¬åœ°æµ‹è¯• Railway é…ç½®

åœ¨éƒ¨ç½²å‰ï¼Œå¯ä»¥æœ¬åœ°æµ‹è¯• Railway å¯åŠ¨å‘½ä»¤ï¼š

```bash
# æµ‹è¯• Railway å¯åŠ¨è„šæœ¬
npm run railway:start

# æˆ–è€…ç›´æ¥è¿è¡Œå¯åŠ¨å‘½ä»¤
cd demo-real && npm install && npm start
```

## 9. æ•…éšœæ’é™¤

### 1. éƒ¨ç½²å¤±è´¥

- æ£€æŸ¥ Railway æ„å»ºæ—¥å¿—
- ç¡®è®¤ `demo-real/package.json` ä¸­çš„ä¾èµ–é¡¹æ­£ç¡®
- éªŒè¯å¯åŠ¨å‘½ä»¤è·¯å¾„

### 2. åº”ç”¨æ— æ³•å¯åŠ¨

- æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
- ç¡®è®¤ç«¯å£é…ç½®æ­£ç¡®ï¼ˆä½¿ç”¨ `$PORT`ï¼‰
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—

### 3. Claude CLI è®¤è¯é—®é¢˜

- ç¡®è®¤ Claude CLI å·²æ­£ç¡®å®‰è£…ï¼š`claude --version`
- æ£€æŸ¥è®¤è¯çŠ¶æ€ï¼š`claude auth status`
- å¦‚æœæœªè®¤è¯ï¼ŒæŒ‰ç…§ä¸Šè¿°æ­¥éª¤é‡æ–°è¿è¡Œ `claude login`
- ç¡®ä¿åœ¨ Railway ç»ˆç«¯ä¸­å®Œæˆè®¤è¯æµç¨‹

## 10. æˆæœ¬ä¼°ç®—

 Railway å…è´¹è®¡åˆ’åŒ…æ‹¬ï¼š
- $5/æœˆ å…è´¹é¢åº¦
- 512MB RAM
- 1GB ç£ç›˜ç©ºé—´
- æ— é™åˆ¶çš„æ„å»ºæ—¶é—´

å¯¹äºæ¼”ç¤ºé¡¹ç›®ï¼Œå…è´¹è®¡åˆ’é€šå¸¸è¶³å¤Ÿä½¿ç”¨ã€‚

## 11. ç›‘æ§å’Œæ—¥å¿—

1. **å®æ—¶æ—¥å¿—**: Railway æ§åˆ¶å°æä¾›å®æ—¶æ—¥å¿—æŸ¥çœ‹
2. **æŒ‡æ ‡ç›‘æ§**: CPUã€å†…å­˜ä½¿ç”¨æƒ…å†µç›‘æ§
3. **éƒ¨ç½²å†å²**: æŸ¥çœ‹æ‰€æœ‰éƒ¨ç½²è®°å½•
4. **å›æ»šåŠŸèƒ½**: ä¸€é”®å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬

## 12. æ›´æ–°éƒ¨ç½²

1. æ¨é€ä»£ç åˆ° GitHub
2. Railway è‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²
3. é›¶åœæœºæ—¶é—´æ›´æ–°

## 13. è‡ªåŠ¨åŒ–è„šæœ¬è¯¦è§£

### ğŸ“ è„šæœ¬æ–‡ä»¶ç»“æ„

```
scripts/
â”œâ”€â”€ railway-setup.sh      # Railway CLI è‡ªåŠ¨åŒ–è®¾ç½®
â”œâ”€â”€ claude-auth.sh        # Claude CLI è®¤è¯è„šæœ¬
â”œâ”€â”€ verify-auth.sh        # è®¤è¯çŠ¶æ€éªŒè¯è„šæœ¬
â””â”€â”€ health-check.sh       # å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨æ¢å¤
```

### ğŸ› ï¸ è„šæœ¬åŠŸèƒ½è¯¦è§£

#### railway-setup.sh
- è‡ªåŠ¨å®‰è£… Railway CLI
- å¤„ç† Railway ç™»å½•
- è‡ªåŠ¨è¿æ¥é¡¹ç›®
- æ˜¾ç¤ºé¡¹ç›®ä¿¡æ¯

#### claude-auth.sh
- åŠè‡ªåŠ¨åŒ– Claude CLI è®¤è¯æµç¨‹
- å¼•å¯¼ç”¨æˆ·å®Œæˆ OAuth è®¤è¯
- è‡ªåŠ¨éªŒè¯è®¤è¯ç»“æœ
- æµ‹è¯•åº”ç”¨åŠŸèƒ½

#### verify-auth.sh
- å…¨é¢æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
- éªŒè¯ Railway CLI è¿æ¥
- æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€
- éªŒè¯ Claude CLI è®¤è¯
- ç”Ÿæˆè¯¦ç»†çŠ¶æ€æŠ¥å‘Š

#### health-check.sh
- æŒç»­å¥åº·ç›‘æ§
- è‡ªåŠ¨æ•…éšœæ£€æµ‹
- è‡ªåŠ¨æ¢å¤åŠŸèƒ½
- é‡è¯•æœºåˆ¶
- æ—¥å¿—è®°å½•

### ğŸ¯ ä½¿ç”¨åœºæ™¯

#### é¦–æ¬¡éƒ¨ç½²
```bash
# ä¸€é”®å¼å®Œæ•´éƒ¨ç½²
npm run deploy:full
```

#### æ—¥å¸¸ç»´æŠ¤
```bash
# å¥åº·æ£€æŸ¥
npm run railway:health

# çŠ¶æ€éªŒè¯
npm run railway:verify

# æŒç»­ç›‘æ§
npm run railway:monitor
```

#### æ•…éšœæ¢å¤
```bash
# é‡æ–°è®¤è¯
npm run railway:auth

# å®Œæ•´æ¢å¤æµç¨‹
npm run deploy:setup
```

### âš™ï¸ é«˜çº§é…ç½®

#### ç¯å¢ƒå˜é‡é…ç½®
```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
DEBUG=true npm run railway:verify

# è‡ªå®šä¹‰é‡è¯•å‚æ•°
MAX_RETRIES=5 npm run railway:health

# è®¾ç½®ç›‘æ§é—´éš”
HEALTH_CHECK_INTERVAL=600 npm run railway:monitor
```

#### Webhook é€šçŸ¥
```bash
# é…ç½®é€šçŸ¥ Webhook
export WEBHOOK_URL="https://hooks.slack.com/services/..."
npm run railway:monitor
```

### ğŸ” æ•…éšœæ’é™¤

#### è„šæœ¬æƒé™é—®é¢˜
```bash
# ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
chmod +x scripts/*.sh
```

#### Railway CLI é—®é¢˜
```bash
# é‡æ–°å®‰è£… Railway CLI
npm install -g @railway/cli

# é‡æ–°ç™»å½•
railway logout && railway login
```

#### è®¤è¯å¤±è´¥
```bash
# æ¸…ç†è®¤è¯çŠ¶æ€
railway ssh --command "rm -rf ~/.claude"

# é‡æ–°è®¤è¯
npm run railway:auth
```

### ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

#### æ—¥å¿—æ–‡ä»¶
- `health-check.log` - å¥åº·æ£€æŸ¥æ—¥å¿—
- æ‰€æœ‰è„šæœ¬éƒ½ä¼šè®°å½•è¯¦ç»†çš„æ“ä½œæ—¥å¿—

#### ç›‘æ§æŒ‡æ ‡
- Railway CLI è¿æ¥çŠ¶æ€
- åº”ç”¨å¥åº·çŠ¶æ€
- Claude CLI è®¤è¯çŠ¶æ€
- è‡ªåŠ¨æ¢å¤æˆåŠŸç‡

---

**é‡è¦æé†’**: Railway æ”¯æŒé•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨ï¼Œéå¸¸é€‚åˆéœ€è¦ä¿æŒ Claude CLI è¿æ¥çš„é¡¹ç›®ã€‚ç›¸æ¯” Vercel çš„ serverless é™åˆ¶ï¼ŒRailway æä¾›äº†æ›´å¥½çš„å…¼å®¹æ€§ã€‚ç°åœ¨é€šè¿‡è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œè®¤è¯å’Œç®¡ç†è¿‡ç¨‹å·²ç»å¤§å¤§ç®€åŒ–ï¼Œä½†è¯·æ³¨æ„æ¯æ¬¡é‡æ–°éƒ¨ç½²åå¯èƒ½éœ€è¦é‡æ–°è¿›è¡Œ Claude CLI è®¤è¯ã€‚